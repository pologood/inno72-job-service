<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inno72.job.executer.mapper.OrderMapper">
    <select id="findSuccessOrder" resultType="com.inno72.job.executer.vo.OrderOrderGoodsVo">
   select o.order_time as orderTime,
    guc.channel_user_key as taobaoUserId,
    machine.machine_code machineCode,
    o.ref_order_id as taobaoOrderNum,
     orderGoods.goods_code as taobaoGoodsId ,
    mht.merchant_code as merchantCode,
    mht.merchant_name as merchantName
    from inno72_order_goods orderGoods
     join inno72_order o on orderGoods.order_id = o.id
     join inno72_goods g on orderGoods.goods_id = g.id
     left join inno72_game_user_channel guc on guc.game_user_id = o.user_id
     left join inno72_machine machine on o.machine_id = machine.id
     left join inno72_merchant mht on mht.id=g.seller_id
     where o.goods_status=1 and o.goods_type = 1
    limit #{currIndex} , #{pageSize}
    </select>

 <select id="findByFeedBackErrorLog" resultType="com.inno72.job.executer.vo.OrderOrderGoodsVo">
   select o.order_time as orderTime,
    guc.channel_user_key as taobaoUserId,
    machine.machine_code machineCode,
    o.ref_order_id as taobaoOrderNum,
     orderGoods.goods_code as taobaoGoodsId ,
    mht.merchant_code as merchantCode,
    mht.merchant_name as merchantName
    from inno72_feedback_errorlog elog
	join inno72_order o on elog.order_id = o.ref_order_id
     left join inno72_order_goods orderGoods on orderGoods.order_id = o.id
     left join inno72_goods g on orderGoods.goods_id = g.id
     left join inno72_game_user_channel guc on guc.game_user_id = o.user_id
     left join inno72_machine machine on o.machine_id = machine.id
     left join inno72_merchant mht on mht.id=g.seller_id
     where o.goods_status=1 and o.goods_type = 1
    limit #{currIndex} , #{pageSize}
    </select>
 <delete id="deleteFeedBackErrorLogByOrderId">
      delete from inno72_feedback_errorlog where order_id=#{orderId}
 </delete>
</mapper>